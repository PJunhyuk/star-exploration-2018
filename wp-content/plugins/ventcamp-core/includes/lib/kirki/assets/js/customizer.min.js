function RepeaterRow(e,t){this.rowIndex=e,this.rowNumber=e+1,this.$el=t,this.$dragger=this.$el.find(".repeater-row-move"),this.$minimizer=this.$el.find(".repeater-row-minimize"),this.$remover=this.$el.find(".repeater-row-remove"),this.$number=this.$el.find(".repeater-row-number"),this.$fields=this.$el.find("input,select,textarea");var i=this;this.$minimizer.on("click",function(){i.toggleMinimize()}),this.$remover.on("click",function(){i.remove()}),this.$dragger.on("mousedown",function(){i.$el.trigger("row:start-dragging")}),this.$el.on("keyup change","input, select, textarea",function(e){i.$el.trigger("row:update",[i.getRowIndex(),jQuery(e.target).data("field"),e.target])}),this.renderNumber()}function kirkiArrayToObject(e){var t={};if(null!==e)for(var i=0;i<e.length;++i)void 0!==e[i]&&(t[i]=e[i]);return t}wp.customize.controlConstructor["kirki-checkbox"]=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)})}}),wp.customize.controlConstructor.code=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("#kirki-codemirror-editor-"+e.id),i=CodeMirror.fromTextArea(t[0]);i.setOption("value",e.setting._value),i.setOption("mode",e.params.choices.language),i.setOption("lineNumbers",!0),i.setOption("theme",e.params.choices.theme),i.setOption("height",e.params.choices.height+"px"),i.on("change",function(){e.setting.set(i.getValue())})}}),wp.customize.controlConstructor.dimension=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("input[type=number]").val(),i=e.container.find("select").val();jQuery(".customize-control-dimension select").selectize(),this.container.on("change","input",function(){t=jQuery(this).val(),e.setting.set(t+i)}),this.container.on("change","select",function(){i=jQuery(this).val(),e.setting.set(t+i)})}}),function(e){wp.customizerCtrlEditor={init:function(){e(window).load(function(){e("textarea.wp-editor-area").each(function(){var t,i,n=e(this),r=n.attr("id"),o=e('input[data-customize-setting-link="'+r+'"]'),s=tinyMCE.get(r);s&&s.on("change",function(e){s.save(),i=s.getContent(),clearTimeout(t),t=setTimeout(function(){o.val(i).trigger("change")},500)}),n.css({visibility:"visible"}).on("keyup",function(){i=n.val(),clearTimeout(t),t=setTimeout(function(){o.val(i).trigger("change")},500)})})})}},wp.customizerCtrlEditor.init()}(jQuery),wp.customize.controlConstructor.multicheck=wp.customize.Control.extend({ready:function(){var e=this;e.container.on("change","input",function(){var t=[],i=0;jQuery.each(e.params.choices,function(e,n){jQuery('input[value="'+e+'"').is(":checked")&&(t[i]=e,i++)}),e.setting.set(t),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor["kirki-number"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("input");if(jQuery(t).spinner(),e.params.choices.min&&jQuery(t).spinner("option","min",e.params.choices.min),e.params.choices.max&&jQuery(t).spinner("option","max",e.params.choices.max),e.params.choices.step){var i="any"==e.params.choices.step?"0.001":e.params.choices.step;jQuery(t).spinner("option","step",i)}this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.palette=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.preset=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select");jQuery(t).selectize(),this.container.on("change","select",function(){var t=jQuery(this).val();e.setting.set(t),jQuery.each(e.params.choices,function(e,i){t==e&&jQuery.each(i.settings,function(e,t){var i=wp.customize.settings.controls[e];if(void 0===typeof i)return!0;var n=i.type;if("checkbox"==n||"switch"==n||"toggle"==n||"kirki-checkbox"==n){var r=wp.customize.control(e).container.find("input");1==t?(jQuery(r).prop("checked",!0),wp.customize.instance(e).set(!0)):(jQuery(r).prop("checked",!1),wp.customize.instance(e).set(!1))}else if("select"==n||"select2"==n||"select2-multiple"==n||"kirki-select"==n){r=wp.customize.control(e).container.find("select");jQuery(r).selectize()[0].selectize.setValue(t,!0),wp.customize.instance(e).set(t)}else if("slider"==n){r=wp.customize.control(e).container.find("input");jQuery(r).prop("value",t);var o=wp.customize.control(e).container.find(".kirki_range_value .value");jQuery(o).html(t),wp.customize.instance(e).set(t)}else if("textarea"==n||"kirki-textarea"==n){r=wp.customize.control(e).container.find("textarea");jQuery(r).prop("value",t),wp.customize(e).set(t)}else if("kirki-color"===n){wp.customize.control(e).container.find(".kirki-color-control").attr("data-default-color",t).data("default-color",t).wpColorPicker("color",t),wp.customize.instance(e).set(t)}else if("dimension"==n){wp.customize.instance(e).set(t);r=wp.customize.control(e).container.find("input[type=number]");var s=parseFloat(t);jQuery(r).prop("value",s);var a=wp.customize.control(e).container.find("select"),c=t.replace(parseFloat(t),"");jQuery(a).prop("value",c)}else if("multicheck"==n)for(wp.customize.instance(e).set(t),wp.customize.control(e).container.find("input").each(function(){jQuery(this).prop("checked",!1)}),index=0;index<t.length;index++){r=wp.customize.control(e).container.find('input[value="'+t[index]+'"]');jQuery(r).prop("checked",!0)}else if("radio-buttonset"==n||"radio-image"==n||"radio"==n||"kirki-radio"==n){r=wp.customize.control(e).container.find('input[value="'+t+'"]');jQuery(r).prop("checked",!0),wp.customize.instance(e).set(t)}else{r=wp.customize.control(e).container.find("input");jQuery(r).prop("value",t),wp.customize.instance(e).set(t)}})}),wp.customize.previewer.refresh()})}}),wp.customize.controlConstructor["radio-buttonset"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["radio-image"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["kirki-radio"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),RepeaterRow.prototype.getRowIndex=function(){return this.rowIndex},RepeaterRow.prototype.getRowNumber=function(){return this.rowNumber},RepeaterRow.prototype.setRowNumber=function(e){this.rowNumber=e,this.renderNumber()},RepeaterRow.prototype.getElement=function(){return this.$el},RepeaterRow.prototype.setRowIndex=function(e){this.rowIndex=e,this.$el.attr("data-row",e),this.$el.data("row",e)},RepeaterRow.prototype.toggleMinimize=function(){this.$el.toggleClass("minimized"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").toggleClass("dashicons-arrow-down")},RepeaterRow.prototype.minimize=function(){this.$el.addClass("minimized"),this.$minimizer.find(".repeater-minimize").removeClass("dashicons-arrow-up"),this.$minimizer.find(".repeater-minimize").addClass("dashicons-arrow-down")},RepeaterRow.prototype.remove=function(){confirm("Are you sure?")&&(this.$el.slideUp(300,function(){jQuery(this).detach()}),this.$el.trigger("row:remove",[this.getRowIndex()]))},RepeaterRow.prototype.renderNumber=function(){this.$number.text(this.getRowNumber())},wp.customize.controlConstructor.repeater=wp.customize.Control.extend({ready:function(){var e=this,t=this.params.value;if(this.settingField=this.container.find("[data-customize-setting-link]").first(),this.setValue([],!1),this.repeaterFieldsContainer=e.container.find(".repeater-fields").first(),this.currentIndex=0,this.rows=[],e.container.on("click","button.repeater-add",function(t){t.preventDefault(),e.addRow()}),this.repeaterTemplate=_.memoize(function(){var t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(i){return _.template(e.container.find(".customize-control-repeater-content").first().html(),null,t)(i)}}),t.length)for(var i=0;i<t.length;i++)e.addRow(t[i]);this.repeaterFieldsContainer.sortable({handle:".repeater-row-move",update:function(t,i){e.sort()}})},getValue:function(){return JSON.parse(decodeURI(this.setting.get()))},setValue:function(e,t){this.setting.set(encodeURI(JSON.stringify(e))),t&&this.settingField.trigger("change")},addRow:function(e){var t,i,n=this,r=n.repeaterTemplate(),o=this.getValue(),s={};if(r){if(i=jQuery.extend(!0,{},n.params.fields),e)for(t in e)e.hasOwnProperty(t)&&i.hasOwnProperty(t)&&(i[t].default=e[t]);i.index=this.currentIndex,i.ControlId=this.id,r=r(i);var a=new RepeaterRow(n.currentIndex,jQuery(r).appendTo(n.repeaterFieldsContainer));for(t in a.getElement().one("row:remove",function(e,t){n.deleteRow(t)}),a.getElement().on("row:update",function(e,t,i,r){n.updateField.call(n,e,t,i,r)}),a.getElement().on("row:start-dragging",function(){for(t in n.rows)n.rows.hasOwnProperty(t)&&n.rows[t]&&n.rows[t].minimize()}),this.rows[this.currentIndex]=a,i)i.hasOwnProperty(t)&&(s[t]=i[t].default);o[this.currentIndex]=s,this.setValue(o,!0),this.currentIndex++}},sort:function(){var e=this,t=this.repeaterFieldsContainer.find(".repeater-row"),i=[];t.each(function(e,t){i.push(jQuery(t).data("row"))});var n=e.getValue(),r=[],o=[];jQuery.each(i,function(t,i){r[t]=e.rows[i],r[t].setRowIndex(t),r[t].setRowNumber(t+1),o[t]=n[i]}),e.rows=r,e.setValue(o)},deleteRow:function(e){var t=this.getValue();t[e]&&(this.rows[e]&&(delete t[e],delete this.rows[e],this.setValue(t,!0)));var i=1;for(prop in this.rows)this.rows.hasOwnProperty(prop)&&this.rows[prop]&&(this.rows[prop].setRowNumber(i),i++)},updateField:function(e,t,i,n){if(this.rows[t]&&this.params.fields[i]){var r=this.params.fields[i].type,o=this.rows[t],s=this.getValue();n=jQuery(n),null!=typeof s[o.getRowIndex()][i]&&(s[o.getRowIndex()][i]="checkbox"==r?n.is(":checked"):n.val(),this.setValue(s,!0))}}}),wp.customize.controlConstructor["kirki-select"]=wp.customize.Control.extend({ready:function(){var e=this,t=this.container.find("select"),i=parseInt(t.data("multiple"));i>1?jQuery(t).selectize({maxItems:i,plugins:["remove_button","drag_drop"]}):jQuery(t).selectize(),this.container.on("change","select",function(){if(i>1)var t=kirkiArrayToObject(jQuery(this).val());else t=jQuery(this).val();e.setting.set(t)})}}),jQuery(document).ready(function(e){e("input[type=range]").on("mousedown",function(){value=e(this).attr("value"),e(this).mousemove(function(){value=e(this).attr("value"),e(this).closest("label").find(".kirki_range_value .value").text(value)})}),e(".kirki-slider-reset").click(function(){var t=e(this).closest("label").find("input"),i=(t.data("customize-setting-link"),t.data("reset_value"));t.val(i),t.change()})}),wp.customize.controlConstructor.slider=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.sortable=wp.customize.Control.extend({ready:function(){var e=this;this.settingField=this.container.find("[data-customize-setting-link]").first(),this.sortableContainer=this.container.find("ul.sortable").first(),this.setValue(this.setting.get(),!1),this.sortableContainer.sortable().disableSelection().on("sortstop",function(t,i){e.sort()}).find("li").each(function(){jQuery(this).find("i.visibility").click(function(){jQuery(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){e.sort()})},sort:function(){var e=[];this.sortableContainer.find("li").each(function(){var t=jQuery(this);t.is(".invisible")||e.push(t.data("value"))}),this.setValue(e,!0)},getValue:function(){return unserialize(this.setting.get())},setValue:function(e,t){e=serialize(e),this.setting.set(e),this.settingField.val(e),t&&this.settingField.trigger("change")}}),wp.customize.controlConstructor.spacing=wp.customize.Control.extend({ready:function(){var e=this,t={};if(e.container.has(".top").size()&&(t.top=e.setting._value.top),e.container.has(".bottom").size()&&(t.bottom=e.setting._value.bottom),e.container.has(".left").size()&&(t.left=e.setting._value.left),e.container.has(".right").size()&&(t.right=e.setting._value.right),jQuery(".customize-control-spacing select").selectize(),e.container.has(".top").size()){var i=e.container.find(".top input[type=number]").val(),n=e.container.find(".top select").val();this.container.on("change",".top input",function(){i=jQuery(this).val(),t.top=i+n,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".top select",function(){n=jQuery(this).val(),t.top=i+n,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".bottom").size()){var r=e.container.find(".bottom input[type=number]").val(),o=e.container.find(".bottom select").val();this.container.on("change",".bottom input",function(){r=jQuery(this).val(),t.bottom=r+o,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".bottom select",function(){o=jQuery(this).val(),t.bottom=r+o,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".left").size()){var s=e.container.find(".left input[type=number]").val(),a=e.container.find(".left select").val();this.container.on("change",".left input",function(){s=jQuery(this).val(),t.left=s+a,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".left select",function(){a=jQuery(this).val(),t.left=s+a,e.setting.set(t),wp.customize.previewer.refresh()})}if(e.container.has(".right").size()){var c=e.container.find(".right input[type=number]").val(),u=e.container.find(".right select").val();this.container.on("change",".right input",function(){c=jQuery(this).val(),t.right=c+u,e.setting.set(t),wp.customize.previewer.refresh()}),this.container.on("change",".right select",function(){u=jQuery(this).val(),t.right=c+u,e.setting.set(t),wp.customize.previewer.refresh()})}}}),wp.customize.controlConstructor.switch=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)})}}),wp.customize.controlConstructor["kirki-textarea"]=wp.customize.Control.extend({ready:function(){var e=this;this.container.on("change keyup paste",".textarea",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor.toggle=wp.customize.Control.extend({ready:function(){var e=this,t=e.setting._value;this.container.on("change","input",function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)})}}),wp.customize.controlConstructor.typography=wp.customize.Control.extend({ready:function(){var e=this,t={};window.control=this;var i=function(){e.container.has(".uppercase").size()&&(e.setting._value.uppercase?t.uppercase=!0:t.uppercase=!1),e.container.has(".italic").size()&&(e.setting._value.italic?t.italic=!0:t.italic=!1),e.container.has(".underline").size()&&(e.setting._value.underline?t.underline=!0:t.underline=!1),e.container.has(".strikethrough").size()&&(e.setting._value.strikethrough?t.strikethrough=!0:t.strikethrough=!1),e.container.has(".font-family").size()&&(t["font-family"]=e.setting._value["font-family"]+""),e.container.has(".font-size").size()&&(t["font-size"]=e.setting._value["font-size"]+""),e.container.has(".font-weight").size()&&(t["font-weight"]=e.setting._value["font-weight"]+""),e.container.has(".line-height").size()&&(t["line-height"]=e.setting._value["line-height"]+""),e.container.has(".letter-spacing").size()&&(t["letter-spacing"]=e.setting._value["letter-spacing"]+"")};i(),jQuery(".customize-control-typography select").selectize(),e.container.has(".uppercase").size()&&this.container.on("change",".uppercase input",function(){var n=!1;jQuery(this).is(":checked")&&(n=!0),t=jQuery.extend({},t,{uppercase:n}),e.setting.set(t),i()}),e.container.has(".italic").size()&&this.container.on("change",".italic input",function(){var n=!1;jQuery(this).is(":checked")&&(n=!0),t=jQuery.extend({},t,{italic:n}),e.setting.set(t),i()}),e.container.has(".underline").size()&&this.container.on("change",".underline input",function(){var n=!1;jQuery(this).is(":checked")&&(n=!0),t=jQuery.extend({},t,{underline:n}),e.setting.set(t),i()}),e.container.has(".strikethrough").size()&&this.container.on("change",".strikethrough input",function(){var n=!1;jQuery(this).is(":checked")&&(n=!0),t=jQuery.extend({},t,{strikethrough:n}),e.setting.set(t),i()}),e.container.has(".font-family").size()&&this.container.on("change",".font-family select",function(){t=jQuery.extend({},t,{"font-family":jQuery(this).val()}),e.setting.set(t),i()}),e.container.has(".font-size").size()&&(this.container.on("change",".font-size input",function(){var n=e.container.find(".font-size select").val();t=jQuery.extend({},t,{"font-size":jQuery(this).val()+n}),e.setting.set(t),i()}),this.container.on("change",".font-size select",function(){var n=e.container.find(".font-size input[type=number]").val();t=jQuery.extend({},t,{"font-size":n+jQuery(this).val()}),e.setting.set(t),i()})),e.container.has(".font-weight").size()&&this.container.on("change",".font-weight select",function(){t=jQuery.extend({},t,{"font-weight":jQuery(this).val()}),e.setting.set(t),i()}),e.container.has(".line-height").size()&&this.container.on("change",".line-height input",function(){t=jQuery.extend({},t,{"line-height":jQuery(this).val()}),e.setting.set(t),i()}),e.container.has(".letter-spacing").size()&&(this.container.on("change",".letter-spacing input",function(){var n=e.container.find(".letter-spacing select").val();t=jQuery.extend({},t,{"letter-spacing":jQuery(this).val()+n}),e.setting.set(t),i()}),this.container.on("change",".letter-spacing select",function(){var n=e.container.find(".letter-spacing input[type=number]").val();t=jQuery.extend({},t,{"letter-spacing":n+jQuery(this).val()}),e.setting.set(t),i()}))}});